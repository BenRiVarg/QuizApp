<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <!--
  <link rel="stylesheet" href="/code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
-->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="cache-control" content="no-cache" />
  <style>
    #div10,
    #div11,
    #draggable {
      float: left;
      width: 100px;
      height: 35px;
      margin: 10px;
      padding: 10px;
      border: 1px solid black;
    }

    #draggable {
      cursor: move;
      text-align: center;
      width: 100px;
      height: 100px;
      padding: 0.5em;
      float: left;
      margin: 10px 10px 10px 0;
    }

    #droppable {
      width: 350px;
      height: 600px;
      padding: 0.5em;
      float: left;
      margin: 10px;
    }

    #div {
      float: left;
    }

    #divImg {
      background-image: url('');
      background-size: cover;
      background-position: center;
      height: 350px;
      width: 600px;
      border: 1px solid #bbb;
    }

    .correcto,
    #incorrecto {
      background-color: aliceblue;
      background-size: cover;
      color: red;
      background-position: center;
      height: 33px;
      width: 81px;
      border: 1px solid #bbb;
    }

    .btn-flotante {
      font-size: 16px;
      /* Cambiar el tamaño de la tipografia */
      text-transform: uppercase;
      /* Texto en mayusculas */
      font-weight: bold;
      /* Fuente en negrita o bold */
      color: #ffffff;
      /* Color del texto */
      border-radius: 5px;
      /* Borde del boton */
      letter-spacing: 2px;
      /* Espacio entre letras */
      background-color: cyan;
      /* Color de fondo */
      padding: 18px 30px;
      /* Relleno del boton */
      position: fixed;
      bottom: 40px;
      right: 40px;
      transition: all 300ms ease 0ms;
      box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.1);
      z-index: 99;
    }

    .btn-flotante:hover {
      background-color: #2c2fa5;
      /* Color de fondo al pasar el cursor */
      box-shadow: 0px 15px 20px rgba(0, 0, 0, 0.3);
      transform: translateY(-7px);
    }

    @media only screen and (max-width: 600px) {
      .btn-flotante {
        font-size: 14px;
        padding: 12px 20px;
        bottom: 20px;
        right: 20px;
      }
    }

    .crearQ{
      width: 310px;
      height: 38px;
      border-radius: 5px;
      border: 2px solid rgb(64, 81, 233);
      font-size: 22px;
    }
    ::placeholder {
      color: rgb(20, 20, 126);
      font-size: 1.2rem;
    }
  </style>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  
  <link rel="stylesheet" type="text/css" href="/css/style.css">

  <!-- Sidebar -->
  <div class="w3-sidebar w3-bar-block w3-border-right w3-light" style="display:none" style="position: fixed;"
    id="mySidebar">
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Cierra esta pestaña" delay="0" tabindex="0"
      class="d-inline-block">
      <button onclick="w3_close()" class="w3-bar-item w3-large w3-light">Cerrar &times;</button>
    </span>
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click para insertar Pregunta Abierta" delay="0"
      tabindex="0" class="d-inline-block">
      <button onclick="preguntaAbierta()" class="w3-bar-item w3-button">Insertar Pregunta Abierta</button>
      </sapn>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para agregar pregunta relacional"
        delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaRelacional()" class="w3-bar-item w3-button">Insertar Pregunta Relacional</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip"
        title="Da click aqui para crear una pregunta de opcion multiple" delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaOM()" class="w3-bar-item w3-button">Insertar Pregunta Opción Múltiple</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear una pregunta de con imagen"
        delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaIT()" class="w3-bar-item w3-button">Insertar Pregunta-Imagen</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip"
        title="Da click aqui para creaa una pregunta de matematicas" delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaMatematicas()" class="w3-bar-item w3-button">Insertar Pregunta de Matemáticas</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear tu pregunta arrrastrable"
        delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaArrastrar()" class="w3-bar-item w3-button" >Inserta Pregunta Arrastrable
        </button>
      </span>
  </div>
  <script>

    function w3_open() {
      document.getElementById("mySidebar").style.display = "block";
    }

    function w3_close() {
      document.getElementById("mySidebar").style.display = "none";
    }
  </script>
  <title>Crear Examen</title>
</head>

<body>
  <!-- Sidebar -->
  <div class="w3-sidebar w3-bar-block w3-border-right w3-light" style="display:none" style="position: fixed;"
    id="mySidebar">
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Cierra esta pestaña" delay="0" tabindex="0"
      class="d-inline-block">
      <button onclick="w3_close()" class="w3-bar-item w3-large w3-light">Cerrar &times;</button>
    </span>
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click para insertar Pregunta Abierta" delay="0"
      tabindex="0" class="d-inline-block">
      <button onclick="preguntaAbierta()" class="w3-bar-item w3-button">Insertar Pregunta Abierta</button>
      </sapn>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para agregar pregunta relacional"
        delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaRelacional()" class="w3-bar-item w3-button">Insertar Pregunta Relacional</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip"
        title="Da click aqui para crear una pregunta de opcion multiple" delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaOM()" class="w3-bar-item w3-button">Insertar Pregunta Opción Múltiple</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear una pregunta de con imagen"
        delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaIT()" class="w3-bar-item w3-button">Insertar Pregunta-Imagen</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip"
        title="Da click aqui para creaa una pregunta de matematicas" delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaMatematicas()" class="w3-bar-item w3-button">Insertar Pregunta de Matemáticas</button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear tu pregunta arrrastrable"
        delay="0" tabindex="0" class="d-inline-block">
        <button onclick="preguntaArrastrar()" class="w3-bar-item w3-button" >Inserta Pregunta Arrastrable
        </button>
      </span>
  </div>
  <!-- Page Content -->
  <div class="w3-light-gray w3-nav-bar">
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Abre esta pestaña para agregar preguntas" delay="0"
      tabindex="0" class="d-inline-block">
      <button class="w3-button w3-bar-item d-inline-block rounded-sm bg-info " style="position: fixed;"
        onclick="w3_open()">☰</button>
    </span>

    <h4 class="display w3-bar-item d-inline-block" onclick="">QuizApp</h4>
    <p class="display w3-bar-item d-inline-block" onclick="">Help</p>
    <p class="display w3-bar-item d-inline-block" onclick="">FAQ</p>

  </div>
  <br>
  <div class="row justify-content-center mt-5 pt-5">
    <header class="text-center mb-5">
      <h1>Crea un nuevo exámen</h1>
    </header>
  </div>

  <form action="/editores/crear" id="formularioQuizz" method="POST" enctype="multipart/form-data" align="center">
    <div class="row justify-content-center mt-5 pt-5">
      <div class="col-lg-7">
        <select id="nivel" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="nivel" required>
          <option selected>Nivel</option>

        </select>
      </div>
      <div class="col-lg-7">
        <select id="grados" class="form-select form-select-lg mb-3" aria-label=".form-select-sm example" name="grado"  required>
          <option selected>Grado</option>
        
        </select>
        
      </div>
      <div class="col-lg-7">
      <select id="materias" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="claveMateria" required>
        <option selected>Materia</option>
      
      </select>
      </div>
      <div class="col-lg-7">
        <select id="bloques" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="bloques" required>
          <option selected>Bloque</option>
      
        </select>
      </div>
      <div class="col-lg-7">
        <select id="secuencias" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="Secuencias"
          required>
          <option selected>Secuencias</option>
      
        </select>
      </div>
    </div>
    <br>
    <br>
    <div class="text-center">
      <p class="display-6">Nombre del Quizz:</p>

      <input class="crearQ" type="text" placeholder="Coloca el nombre:" name="nombreQuizz">

    </div>
    <!-- Inserto de nuevas preguntas-->

    <div class="row justify-content-center mt-5 pt-5" id="insercion">

    </div>

  </form>

  <div class="boton3">
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear tu Quizz" delay="0"
      tabindex="0" class="d-inline-block">
      <button type="button" class="btn-flotante" onclick="envioQuizz()">Crear Quizz</button>
    </span>
  </div>

  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
  <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
  <script src="http://code.jquery.com/ui/1.8.21/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
  <script src="/js/creadorQuizzes.js" type="text/javascript"></script>
  <script>
    $.getJSON("/pruebaAJAXniveles", function (niveles) {
      for (var i = 0; i < niveles.length; i++) {
        var nombres = (niveles[i].nombre);
        var id = (niveles[i].id);
        var select = document.getElementById("nivel").innerHTML +=
          "<option value='"+ id +"'>" + nombres + "</option>";
        
       /*   console.log(nombres); */
      }
       
    });

     $.getJSON("/pruebaAJAXgrados", function (grados) {
     /*    for (var i = 0; i < 6; i++) {
          var nombres = (grados[i].nombre);
          var id = (grados[i].id);
          var select = document.getElementById("grados").innerHTML +=
            "<option value='" + id + "'>" + nombres + "</option>";
         
          console.log(nombres);
        } */

       var visible = document.getElementById("grados").style.display = "none"; 
      });

        $.getJSON("/pruebaAJAXmaterias", function (materias) {
            /* for (var i = 0; i < 6; i++) {
              var nombres = (materias[i].nombre);
              var id = (materias[i].id);
              var select = document.getElementById("materias").innerHTML +=
                "<option value='" + id + "'>" + nombres + "</option>";
              console.log(nombres);
            } */

          var visible = document.getElementById("materias").style.display = "none"; 
          });

           $.getJSON("/pruebaAJAXbloques", function (bloques) {
           /*    for (var i = 0; i < 6; i++) {
                var nombres = (bloques[i].nombre);
                var id = (bloques[i].id);
                var select = document.getElementById("bloques").innerHTML +=
                  "<option value='" + id + "'>" + nombres + "</option>";
              
                console.log(nombres); 
              } */

             var visible = document.getElementById("bloques").style.display = "none"; 
            });

            
              $.getJSON("/pruebaAJAXsecuencias", function (secuencias) {
               /*  for (var i = 0; i < 6; i++) {
                  var nombres = (secuencias[i].nombre);
                  var id = (secuencias[i].id);
                  var select = document.getElementById("secuencias").innerHTML +=
                    "<option value='" + id + "'>" + nombres + "</option>";
                
                  console.log(nombres);
                } */

                var visible = document.getElementById("secuencias").style.display = "none";
              });

    $('#nivel').on('change', async function () {
          console.log(this.value);
          var grados= await getGrados(this.value);
          console.log("GRADOS OBTENIDOS")
          console.log(grados);
          console.log(grados[0].id);
          console.log(grados[0].nombre);
          for (var i = 0; i < grados.length; i++) {
          document.getElementById("grados").innerHTML +=
            "<option value='" + (grados[i].id) + "'>" + (grados[i].nombre) + "</option>";
          }
        var visible = document.getElementById("grados").style.display = "block"; 
      });

        $('#grados').on('change', async function () {
            console.log(this.value);
            var materias = await getMaterias(this.value);
            console.log("MATERIAS OBTENIDOS")
            console.log(materias);
            console.log(materias[0].id);
            console.log(materias[0].nombre);
            for (var i = 0; i < materias.length; i++) {
            document.getElementById("materias").innerHTML +=
            "<option value='" + (materias[i].id) + "'>" + (materias[i].nombre) + "</option>";
            }
            var visible = document.getElementById("materias").style.display = "block";
          });

          
            $('#materias').on('change', async function () {
              console.log(this.value);
              var bloques = await getBloques(this.value);
              console.log("BLOQUES OBTENIDOS")
              console.log(bloques);
              console.log(bloques[0].id);
              console.log(bloques[0].nombre);
              for (var i = 0; i < bloques.length; i++) {
              document.getElementById("bloques").innerHTML +=
                  "<option value='" + (bloques[i].id) + "'>" + (bloques[i].nombre) + "</option>";
              } 
              var visible = document.getElementById("bloques").style.display = "block";
            });

             $('#bloques').on('change', async function () {
                console.log(this.value);
                var secuencias = await getSecuencias(this.value);
                console.log("SECUENCIAS OBTENIDOS")
                console.log(secuencias);
                console.log(secuencias[0].id);
                console.log(secuencias[0].nombre);
                for (var i = 0; i < secuencias.length; i++) {
                   document.getElementById("secuencias").innerHTML +=
                    "<option value='" + (secuencias[i].id) + "'>" + (secuencias[i].nombre) + "</option>";
                }
                var visible = document.getElementById("secuencias").style.display = "block";
              });


    async function getGrados(idNivel){

      var gradosDelNivel= await new Promise((resolve, reject) => {
          $.getJSON("/pruebaAJAXgrados/"+idNivel+"", function (grados) {
            
            resolve(grados)
          });
       });

      console.log("Resultado");
      return gradosDelNivel;
    }
     
    async function getMaterias(idGrado){

      var materiasDelGrado= await new Promise((resolve, reject) => {
        $.getJSON("/pruebaAJAXmaterias/"+idGrado+"", function (materias) {
            
            resolve(materias);
           });
       });

       return materiasDelGrado;
   }

   async function getBloques(idMateria){

        var bloquesPorMateria= await new Promise((resolve, reject) => {
          $.getJSON("/pruebaAJAXbloques/"+idMateria+"", function (bloques) {
              
              resolve(bloques);
            });
        });

        return bloquesPorMateria;
    }
      
    async function getSecuencias(idBloque){

      var secuenciasPorBloque= await new Promise((resolve, reject) => {
        $.getJSON("/pruebaAJAXsecuencias/"+idBloque+"", function (secuencias) {
            
            resolve(secuencias);
          });
      });

      return secuenciasPorBloque;
      }
      
     
      
  </script>
</body>

</html>