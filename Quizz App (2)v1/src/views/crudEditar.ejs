<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="cache-control" content="no-cache" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="/css/style.css">
  <link rel="stylesheet" type="text/css" href="/css/editoresCrear.css">

  <title>Crear Examen</title>
</head>

<body data-spy="scroll" data-target="#insercion" data-offset="50" >
  <div class="mallaExito" id="malla"></div>
<!-- Page Content -->
  <div class="w3-light-gray w3-nav-bar">
 
    <h4 class="display w3-bar-item d-inline-block" onclick="">QuizApp</h4>
    <p class="display w3-bar-item d-inline-block" onclick="">Help</p>
    <p class="display w3-bar-item d-inline-block" onclick="">FAQ</p>

  </div>
  <br>
  <div class="row justify-content-center mt-5 pt-5">
    <header class="text-center mb-5">
      <h1>Crea un nuevo exámen</h1>
    </header>
  </div>

  <form action="/editores/editar" id="formularioQuizz" method="POST" enctype="multipart/form-data" align="center">
    <input type="hidden" value="<%= quizz._id %>" name="idQuizz">
    <div class="row justify-content-center mt-5 pt-5">
      <div class="col-lg-7">
        <select id="nivel" class="form-select form-select-lg mb-3 select nivel-0" aria-label=".form-select-lg example" name="nivel" required>
          <option selected>Nivel</option>

        </select>
      </div>
      <div class="col-lg-7">
        <select id="grados" class="form-select form-select-lg mb-3 select nivel-1" aria-label=".form-select-sm example" name="grado"  required>
          <option selected>Grado</option>
        
        </select>
        
      </div>
      <div class="col-lg-7">
      <select id="materias" class="form-select form-select-lg mb-3 select nivel-2" aria-label=".form-select-lg example" name="claveMateria" required>
        <option selected>Materia</option>
      
      </select>
      </div>
      <div class="col-lg-7">
        <select id="bloques" class="form-select form-select-lg mb-3 select nivel-3" aria-label=".form-select-lg example" name="bloques" required>
          <option selected>Bloque</option>
      
        </select>
      </div>
      <div class="col-lg-7">
        <select id="secuencias" class="form-select form-select-lg mb-3 select nivel-4" aria-label=".form-select-lg example" name="Secuencias"
          required>
          <option selected>Secuencias</option>
      
        </select>
      </div>
    </div>
    <br>
    <br>
    <div class="text-center">
      <p class="display-6">Nombre del Quizz:</p>
      <input type="hidden" name="grupo" value="Creado por Especialista">
      <input class="crearQ" type="text" placeholder="Coloca el nombre:" name="nombreQuizz" value="<%= quizz.nombreQuizz%>">

    </div>
    <div class="text-center mt-3">
      <p class="display-6">Intentos Permitidos:</p>
      
      <input class="crearQ" type="number" id="intentos"  value="1" min="1"; name="intentos">

    </div>
    <!--Quizz ya existente-->
    <% for(var i=0;i<quizz.cuestionario.length ; i++){%>
        <% switch (quizz.cuestionario[i].tipo) { case "tipoT" : %>
        <div class="tipoT cuestionario cuestionario  justify-content-center mt-5 pt-5 nivel-Superior">
            <div class="container contenedorErrores">
            </div>
            <div class="row text-center">
              <div class="col-12">
                <div class="rounded-pill">
                  <a class="position-absolute top-0 start-0 translate-middle bg-primary rounded-pill text-light shadow border-1"
                    style="width: 3rem; height:3rem; margin-left: 210px;">
                    <p class="fs-4" style="padding-top: 4px;">3</p>
                  </a>
                </div>
                <div class="text-center mb-5 mt-5">
                  <h3>Pregunta Abierta</h3>
                  <h4 class="text-primary">Intrucciones</h4>
                  <p class="fs-5 justify-content-center text">Escribe la pregunta y la respuesta que quieras que tenga.</p>
                </div>
                <div class="col-md-7" style="margin: 0 auto;">
                  <label for="formGroupExampleInput" class="form-label">Pregunta</label>
                  <input type="text" class="form-control pregunta" placeholder="Escriba la pregunta" value="<%= quizz.cuestionario[i].pregunta[0]%>">
                </div>
                <div class="col-md-7" style="margin: 0 auto;">
                  <label for="formGroupExampleInput2" class="form-label">Respuesta</label>
                  <input type="text" class="form-control respuesta " placeholder="Escriba la respuesta" value="<%= quizz.cuestionario[i].respuesta[0]%>">
      
      
                </div>
                <div class="editar col-md-7" role="group" aria-label="Basic mixed styles example" style="margin: 0 auto;">
                  <br>
                  <button type="button" class="btn btn-danger" onclick="eliminar(this)">Quitar Pregunta</button>
                </div>
      
              </div>
            </div>
      
          </div>
        <% break; case "tipoOM" : %>
            <!--Inicia OM-->
            <div class="tipoOM cuestionario rounded-sm container mt-5 pt-5 nivel-Superior">
              <div class=" row justify-content-center mb-4 contenedorErrores">
              </div>
              <div class="row">
                  <div class="col-12 col-md-12 col-lg-6 justify-content-center">
                        <div class="rounded-pill">
                          <a class="position-absolute top-0 start-0 translate-middle bg-primary rounded-pill text-light shadow border-1"
                            style="width: 3rem; height:3rem;">
                            <p class="fs-4" style="padding-top: 4px; padding-left: 16px;">5</p>
                          </a>
                        </div>
                        <div class="text-center">
                            <h3>Pregunta de Opción Múltiple</h3>
                            <div class="pregunta mt-3">
                              <input type="text" class="form-control pregunta " placeholder="Pregunta para el alumno" value="<%= quizz.cuestionario[i].pregunta[0]%>">
                            </div>
                        </div>
                        <div class="reactivos mt-4 text-center">
                          <div class="row">
                            <% for (var j=1; j<quizz.cuestionario[i].pregunta.length; j++) {%>
                              <% for (var k=0; k<quizz.cuestionario[i].respuesta.length; k++) {%>
                                <% var resultado=(quizz.cuestionario[i].pregunta[j]==quizz.cuestionario[i].respuesta[k])%>
                                <% if(quizz.cuestionario[i].pregunta[j] == quizz.cuestionario[i].respuesta[k]){%>
                                <div class="mb-3 bg-success">
                                  <div>
                                    <input type="text" class="form-control opcion mb-3" placeholder="Verdadero"
                                      value="<%= quizz.cuestionario[i].pregunta[j]%>">
                                    <button type="button" class="btn btn-info"
                                      onclick="seleccionarRespuesta(this)">Correcta</button></br>
                                    <button type="button" class="btn btn-danger mt-2" onclick="borrarReactivoOM(this)">Eliminar
                                      Opción</button>
                                  </div>
                                </div>
                                <% break;%>
                                  <%} else{%>
                                        <% if(k==(quizz.cuestionario[i].respuesta.length-1)){%>
                                          <div class="mb-3">
                                            <div>
                                              <input type="text" class="form-control opcion mb-3" placeholder="Verdadero"
                                                value="<%= quizz.cuestionario[i].pregunta[j]%>">
                                              <button type="button" class="btn btn-info" onclick="seleccionarRespuesta(this)">Correcta</button></br>
                                              <button type="button" class="btn btn-danger mt-2" onclick="borrarReactivoOM(this)">Eliminar
                                                Opción</button>
                                            </div>
                                          </div>
                                          <%} %>
                                    <% } %>
                                <% } %>
                              <% } %>
                          </div>
                        </div>
                        <div class="editar mt-3 text-center" role="group" aria-label="Basic mixed styles example">
                          <button type="button" class="btn btn-success" onclick="reactivoOM(this)">Agregar Reactivo</button>
                          <button type="button" class="btn btn-danger" onclick="eliminar(this)">Quitar Pregunta</button>
                        </div>
                  </div>
                  <div class="col-12 col-md-12 col-lg-6">
                    <div class="text-center">
                      <h4 class="text-primary">Intrucciones</h4>
                      <p class="fs-5 justify-content-center text">Para hacer una pregunta Verdadero-Falso , solo define la
                        pregunta al alumno y selecciona la opción correcta. Si deseas opción Multiple,define la pregunta del alumno,
                        borra los campos de verdadero y falso y escribe las respuestas que desees . Finalmente selecciona las correctas</p>
                    </div>
                  </div>
              </div>
        </div>
        <!--Finaliza OM-->

          <% break; case "tipoR" :%><!-- 
          <h1>Pregunta Relacional</h1><br> -->
          <div class="tipoR cuestionario cuestionario mt-5 pt-5 container nivel-Superior">
          <div class="contenedorErrores">
          </div>
          <div class="row text-center">
            <div class="col-12 col-md-12 col-lg-7">
              <div class="rounded-pill">
                <a class="position-absolute top-0 start-0 translate-middle bg-primary rounded-pill text-light shadow border-1"
                  style="width: 3rem; height:3rem;">
                  <p class="fs-4" style="padding-top: 4px;">4</p>
                </a>
              </div>
              
              <div class="contenedorItem row justify-content-center mb-3">
                <div class="mb-4">
                  <h3 class="text-center">Pregunta Relacional</h3>
                </div>
                <% for (var j=0; j<quizz.cuestionario[i].pregunta.length; j++) {%>
                <div class="container row justify-content-center mb-3">
                  
                  <div class="col-md-5">
                    <div class=""> <input type="text" class="form-control pregunta" placeholder="Pregunta" value="<%= quizz.cuestionario[i].pregunta[j]%>"> </div>
                  </div>
                  <div class="col-md-5">
                    <div class=""> <input type="text" class="form-control respuesta " placeholder="Respuesta" value="<%= quizz.cuestionario[i].respuesta[j]%>"> </div>
                  </div>
                  <div class="col-md-2">
                    <div class=""> <button class="btn btn-danger " type="button"
                        onclick="quitarReactivoRelacional(this)">QuitarReactivo</button> </div>
                  </div>
                </div>
                <% } %> <br>
                <div class="container row justify-content-center mb-4">
                  <div class="col-md-3 ml-0">
                    <div class=""> <button class="btn btn-info " type="button" onclick="reactivoRelacional(this)">Añadir
                        Reactivo</button> </div>
                  </div>
                </div> <br>
                <div class="col-md-3 mr-2 text-center"> <button type="button" class="btn btn-danger" onclick="eliminar(this)">Quitar
                    Pregunta</button> 
                </div>
              </div>
            </div>
            <div class="col-12 col-md-12 col-lg-5">
              <h4 class="text-primary">Intrucciones</h4>
              <p class="fs-5 justify-content-center text">1.- Se debe colocar la respuesta y pregunta en orden 1-1, para que
                pueda evaluar correctamente. </p>
              <P class="fs-5 justify-content-center text">2.- El botón de QuitarReactivo sirve para quitar preguntas, en
                caso de que hayas agregado demás.</P>
              <p class="fs-5 justify-content-center text">3.- Añadir Reactivo sirve para agregar más columnas a relacionar.
              </p>
              <p class="fs-5 justify-content-center text">4.- El botón QuitarPregunta sirve para eliminar la pregunta en
                caso de que no se ocupe colocar ninguna relacional.</p>
            </div>
          </div>
          </div>
            <% break; case "tipoM" : %>
            <div class="tipoM cuestionario justify-content-center mt-5 pt-5 nivel-Superior">
              <div class="container contenedorErrores">
              </div>
              <div class="row">
                <div class="col-12">
                  <div class="rounded-pill">
                    <a class="position-absolute top-0 start-0 translate-middle bg-primary rounded-pill text-light shadow border-1"
                      style="width: 3rem; height:3rem; margin-left: 203px;">
                      <p class="fs-4" style="padding-top: 4px; padding-left: 15px;">2</p>
                    </a>
                  </div>
                  <div class="text-center">
                    <h3>Pregunta de Matemáticas</h3>
                    <h4 class="text-primary">Intrucciones</h4>
                    <p class="fs-5 justify-content-center text">Si requiere escribir una fracción ingrese guion bajo"_" p. ej.
                      3_4
                    </p>
            
                  </div>
                  <div class="col-md-7" style="margin: 0 auto;">
                    <label for="formGroupExampleInput" class="form-label">Expresión</label>
                    <input type="text" class="form-control pregunta" placeholder="Escriba la expresión a mostrar al alumno" value="<%= quizz.cuestionario[i].pregunta[0]%>">
                    <div class="respuesta">
                      <h3 class="text-center mt-3">Respuesta</h3>
                      <input type="text" class="form-control pregunta" placeholder="Escriba la expresión a mostrar al alumno"
                        value="<%= quizz.cuestionario[i].respuesta[0]%>">
                    </div>  
                  </div>
                 
                  <div class="editar col-md-7" role="group" aria-label="Basic mixed styles example" style="margin: 0 auto;">
                    <br>
                    <button type="button" class="btn btn-danger" onclick="eliminar(this)" align="left">Quitar Pregunta</button>
                  </div>
                </div>
              </div>
            </div>
              <% break; case "tipoIT" : %>
              <div id="preg"+(contadorid)+ class="justify-content-center mt-5 pt-5 nivel-Superior">
              <div class="justify-content-center mt-5 pt-5 nivel-Superior">
                <div class="contenedorErrores">
              
                </div>
                <div class="row">
                  <div class="col-12">
                    <div class="rounded-pill">
                      <a class="position-absolute top-0 start-0 translate-middle bg-primary rounded-pill text-light shadow border-1"
                        style="width: 3rem; height:3rem; margin-left: 198px;">
                        <p class="fs-4" style="padding-top: 4px; padding-left: 15px;">1</p>
                      </a>
                    </div>
                    <div class="container tipoIT cuestionario mt-4 col-md-7">
                      <p class="d-none procesoIT">antigua</p>
                      <div class="text-center">
                        <h3>Pregunta Texto-Imagen</h3>
                        <h4 class="text-primary">Intrucciones</h4>
                        <p class="fs-5 justify-content-center text">Seleccione la imagen a cargar, y defina pregunta y respuesta </p>
                        <div class="mb-5">
                          <h3 class="text-center">Imagen cargada</h3>
                          <div id="prevIT<%= i %>" class="mx-auto">
                            <img class="img-fluid" src="/image/<%= quizz.cuestionario[i].pregunta[0] %>" alt="imagen Quizz quizz-ebe">
                          </div><br>
                          
                        </div>
                      </div> 
                      <input required="" type="file" id="imgIT<%= i %>" accept="image/*" class="editableIT imgs" name="imgs"> <input required=""
                        type="hidden" class="imagenrequest">
                     <input type="hidden" class="antiguaIMG" value="<%= quizz.cuestionario[i].pregunta[0] %>">
                      <div class="mb-3"> <label for="formGroupExampleInput" class="form-label">Pregunta</label> <input type="text"
                          class="form-control pregunta" placeholder="Escriba la pregunta" value="<%= quizz.cuestionario[i].pregunta[1]%>"> </div>
                      <div class="mb-3"> <label for="formGroupExampleInput2" class="form-label">Respuesta</label> <input required=""
                          type="text" class="form-control respuesta " placeholder="Escriba la respuesta" value="<%= quizz.cuestionario[i].respuesta[0]%>"> </div>
                      <div class="editar" role="group" aria-label="Basic mixed styles example" float="left" align="left"> <br> <button
                          type="button" class="btn btn-danger" onclick="eliminar(this)" align="left">Quitar Pregunta</button> </div>
                    </div>
                  </div>
                </div>
              </div>
              </div>
                <% break; 
         <!--end Switch-->
    } %>
    <!-- end For-->
   <%} %>
    <!---->
    <!-- Inserto de nuevas preguntas-->
    <div id="insercion">

    </div>
    
  </form>

  <p class="retroError" id="mensaje">Hay campos sin llenar</p>

  
  <div class=" col-10 shadow  mb-5 bg-body rounded mensajeExito " id="msgE">
    <p class="encabezado"> Quizz Modificado con Éxito.</p>
    <p class="contenido"> Redireccionando...</p>
  </div>

  <div class="boton3">
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear tu Quizz" delay="0"
      tabindex="0" class="d-inline-block">
      <button type="button" class="btn-flotante" onclick="editarQuizz()">Modificar Quizz</button>
    </span>
  </div>

  <div class="container1 dropdown">
    <input type="checkbox dropbtn" id="toggle">
    <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para abrir y cerrar el menú de preguntas" delay="0" tabindex="0" class="d-inline-block" >
    <label for="toggle" class="button1"></label>

    </span>
   
    
    <nav class="dropdown-content">
          <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click para insertar Pregunta Abierta" delay="0" tabindex="0" class="d-inline-block" >
        <a  onclick="preguntaAbierta(), sumahref(this.id)" id="ref" class="w3-bar-item w3-button btn"  >Insertar Pregunta Abierta</a>
        </sapn>
        <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para agregar pregunta relacional" delay="0" tabindex="0" class="d-inline-block" >
        <button  id="btn1" class="btn1 btn w3-bar-item w3-button" onclick="preguntaRelacional()"><a id="ref2" onclick="sumahref(this.id)" >Insertar Pregunta Relacional</a></button>
        </span>
        <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear una pregunta de opcion multiple" delay="0" tabindex="0" class="d-inline-block" >
        <a onclick="preguntaOM(), sumahref(this.id)" class="w3-bar-item w3-button btn" id="ref3">Insertar Pregunta Opción Múltiple</a></button>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear una pregunta de con imagen" delay="0" tabindex="0" class="d-inline-block" >
        <a onclick="preguntaIT(),sumahref(this.id)" id="ref4" class="btn w3-bar-item w3-button" >Insertar Pregunta-Imagen</a>
      </span>
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para creaa una pregunta de matematicas" delay="0" tabindex="0" class="d-inline-block" >
        <a onclick="preguntaMatematicas(), sumahref(this.id)" class="btn w3-bar-item w3-button" id="ref5" onclick="sumahref(this.id)" >Insertar Pregunta de Matemáticas</a>
      </span>
    <!--
      <span data-bs-placement="top" data-bs-toggle="tooltip" title="Da click aqui para crear tu pregunta arrrastrable" delay="0" tabindex="0" class="d-inline-block" >
        <buton onclick="preguntaArrastrar()" class="w3-bar-item w3-button" ><a id="ref6" class="" onclick="sumahref(this.id)" >Inserta Pregunta Arrastrable</a></button>
      </span>
    -->
    </nav>
  </div>
  
  </div>
  <script>

    var contadorhref=0;
    function sumahref(id){

      if (id==="ref") {
        var ref = document.getElementById("ref");
        contadorhref++;
        ref.setAttribute("href",'#preg'+contadorhref);
        
        
      }else if (id=="ref2") {
        
          var ref2 = document.getElementById("ref2");
          contadorhref++;
          ref2.setAttribute("href",'#preg'+contadorhref);
          
      }else if (id==="ref3") {
        
          var ref3 = document.getElementById("ref3");
          contadorhref++;
          ref3.setAttribute("href",'#preg'+contadorhref);
          
      }else if (id==="ref4"){
        
        var ref4 = document.getElementById("ref4");
        contadorhref++;
        ref4.setAttribute("href",'#preg'+contadorhref);
        

      }else if (id==="ref5"){
        var ref5 = document.getElementById("ref5");
        contadorhref++;
        ref5.setAttribute("href",'#preg'+contadorhref);
        
      }else if (id==="ref6"){

        var ref6 = document.getElementById("ref6");
        contadorhref++;
        ref6.setAttribute("href",'#preg'+contadorhref)
        
      }else{
        console.log("error de link")
        
      }
    }
    function desabilitado(){
    document.getElementById("btn1").disabled = true;
    
  }
    function habilitar(){
    document.getElementsById("btn1").disabled = false;
    
  }
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" type="text/javascript"></script>
  <script src="/js/creadorQuizzes.js" type="text/javascript"></script>
  <script src="/js/editorQuizzes.js" type="text/javascript"></script>
  <script src="/js/filtroSelects.js" type="text/javascript"></script>

</body>

</html>